{% load static %}
<!doctype html>
<html lang='en'>
<head>
  <meta charset='utf-8'>
  <meta name='viewport' content='width=device-width, initial-scale=1, shrink-to-fit=no'>
  <meta name='description' content='Shop Away - Your favorite online store'>
  <title>{% block title %}Shop Away{% endblock %}</title>
  <!-- SEO-friendly canonical, open graph placeholders -->
  <link rel='canonical' href='{{ request.build_absolute_uri }}' />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" rel="stylesheet">
  <link href="/static/css/theme.css" rel="stylesheet">
  <link href="/static/css/mobile-responsive.css" rel="stylesheet">
  <link href="/static/css/mobile-utilities.css" rel="stylesheet">
  <style>
    /* Critical mobile fixes */
    @media (max-width: 768px) {
      .page-hero {
        display: block !important;
        padding: 1rem 0 !important;
      }
      main {
        display: block !important;
        min-height: 50vh;
      }
      body {
        overflow-x: hidden;
      }
      .container-fluid {
        width: 100%;
        max-width: 100%;
        padding-left: 0.75rem !important;
        padding-right: 0.75rem !important;
      }
      /* Ensure hero carousel is visible on mobile */
      #hero {
        display: block !important;
      }
      .hero-slider {
        display: block !important;
      }
      .carousel {
        display: block !important;
      }
      .carousel-inner {
        display: block !important;
      }
      .carousel-item {
        display: block !important;
      }
      /* Ensure product sections are visible */
      section {
        display: block !important;
      }
      .row {
        display: flex !important;
        flex-wrap: wrap !important;
      }
      .col-6, .col-sm-4, .col-md-3, .col-lg-2 {
        display: block !important;
      }
      /* Force white backgrounds on mobile */
      .card {
        background-color: white !important;
        border: 1px solid #dee2e6 !important;
      }
      .product-card {
        background-color: white !important;
      }
      .card-body {
        background-color: white !important;
      }
      body {
        background-color: #f8f9fa !important;
      }
      main {
        background-color: #f8f9fa !important;
      }
      .container-fluid {
        background-color: #f8f9fa !important;
      }
      /* Add to cart button color */
      .btn-outline-dark {
        border-color: #1baaae !important;
        color: #1baaae !important;
      }
      .btn-outline-dark:hover {
        background-color: #1baaae !important;
        border-color: #1baaae !important;
        color: white !important;
      }
    }
  </style>
</head>
<body>
<div class='top-strip text-white small d-none d-lg-block'>
  <div class='container d-flex justify-content-between py-1'>
    <div>
      <i class='fa fa-bolt me-1'></i> Fast delivery
      <span class='ms-3'><i class='fa fa-rotate-left me-1'></i> Easy returns</span>
      <span class='ms-3'><i class='fa fa-shield-halved me-1'></i> Secure checkout</span>
    </div>
    <div>
      <i class='fa fa-phone me-1'></i> Hotline: <strong>09638-000000</strong>
    </div>
  </div>
</div>
<nav class='navbar navbar-expand-lg navbar-light bg-white shadow-sm sticky-top border-bottom'>
  <div class='container-fluid'>
    <a class='navbar-brand fw-bold' style='color: var(--mint-dark);' href='/'>
      <i class="fa-solid fa-mountain-sun me-1"></i> 
      <span class='d-none d-sm-inline'>ShopAway</span>
      <span class='d-sm-none'>SA</span>
    </a>
    
    <!-- Mobile Cart Icon -->
    <div class='d-lg-none d-flex align-items-center me-2'>
      <a class='nav-link position-relative p-2' href='{% url "cart_view" %}'>
        <i class='fa-solid fa-cart-shopping fs-5'></i>
        {% if cart_count > 0 %}
        <span class='position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger' style='font-size: 0.6rem;'>
          {{ cart_count }}
        </span>
        {% endif %}
      </a>
    </div>
    
    <button class='navbar-toggler border-0' type='button' data-bs-toggle='collapse' data-bs-target='#navMain' aria-controls='navMain' aria-expanded='false' aria-label='Toggle navigation'>
      <span class='navbar-toggler-icon'></span>
    </button>
    
    <div class='collapse navbar-collapse' id='navMain'>
      <!-- Mobile Search -->
      <form class='d-lg-none mb-3' method='get' action='/'>
        <div class='input-group'>
          <input class='form-control' name='q' placeholder='Search products...' aria-label='Search products'>
          <button class='btn' style='background-color: var(--mint-dark); border-color: var(--mint-dark); color: white;' type='submit' aria-label='Search'>
            <i class='fa fa-search'></i>
          </button>
        </div>
      </form>
      
      <!-- Desktop Search -->
      <form class='mx-lg-auto my-2 my-lg-0 flex-grow-1 nav-search d-none d-lg-block' method='get' action='/'>
        <div class='input-group nav-search-group'>
          <input class='form-control nav-search-input' name='q' placeholder='Search products...' aria-label='Search products'>
          <button class='btn nav-search-btn' style='background-color: var(--mint-dark); border-color: var(--mint-dark); color: white;' type='submit' aria-label='Search'>
            <i class='fa fa-search'></i>
          </button>
        </div>
      </form>
      
      <!-- Desktop Navigation -->
      <ul class='navbar-nav ms-lg-3 align-items-lg-center d-none d-lg-flex'>
        <li class='nav-item d-flex align-items-center me-3 text-muted small'>
          <i class='fa fa-phone me-1'></i> 01991095900
        </li>
        <li class='nav-item dropdown position-static'>
          <a class='nav-link dropdown-toggle' href='#' data-bs-toggle='dropdown'>Shop</a>
          <div class='dropdown-menu w-100 border-0 shadow-lg p-3 mega-menu'>
            <div class='row g-3'>
              <div class='col-6 col-md-3'>
                <h6 class='text-uppercase small text-muted'>Categories</h6>
                <ul class='list-unstyled mb-0 small'>
                  <li><a class='dropdown-item' href='/?category=electronics'>Electronics</a></li>
                  <li><a class='dropdown-item' href='/?category=fashion'>Fashion</a></li>
                  <li><a class='dropdown-item' href='/?category=grocery'>Grocery</a></li>
                  <li><a class='dropdown-item' href='/?category=home'>Home & Living</a></li>
                </ul>
              </div>
              <div class='col-6 col-md-3'>
                <h6 class='text-uppercase small text-muted'>Featured</h6>
                <a class='card card-hover border-0 text-decoration-none text-dark' href='/?featured=true'>
                  <div class='card-body py-2'>Top Deals</div>
                </a>
                <a class='card card-hover border-0 text-decoration-none text-dark mt-2' href='/?new=true'>
                  <div class='card-body py-2'>New Arrivals</div>
                </a>
              </div>
              <div class='col-12 col-md-6'>
                <div class='p-3 rounded-3 promo-tile'>
                  <div class='d-flex justify-content-between align-items-center'>
                    <div>
                      <div class='h5 mb-0'>Big Savings Week</div>
                      <div class='small text-muted'>Up to 50% off selected items</div>
                    </div>
                    <a class='btn btn-light btn-sm' href='/?sale=true'>Shop Now</a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </li>
      </ul>
      
      <!-- Mobile Navigation Links -->
      <ul class='navbar-nav d-lg-none'>
        <li class='nav-item'>
          <a class='nav-link d-flex align-items-center py-2' href='/?category=electronics'>
            <i class='fa fa-laptop me-2'></i> Electronics
          </a>
        </li>
        <li class='nav-item'>
          <a class='nav-link d-flex align-items-center py-2' href='/?category=fashion'>
            <i class='fa fa-tshirt me-2'></i> Fashion
          </a>
        </li>
        <li class='nav-item'>
          <a class='nav-link d-flex align-items-center py-2' href='/?category=grocery'>
            <i class='fa fa-shopping-cart me-2'></i> Grocery
          </a>
        </li>
        <li class='nav-item'>
          <a class='nav-link d-flex align-items-center py-2' href='/?category=home'>
            <i class='fa fa-home me-2'></i> Home & Living
          </a>
        </li>
        <li class='nav-item'>
          <a class='nav-link d-flex align-items-center py-2' href='/?featured=true'>
            <i class='fa fa-star me-2'></i> Top Deals
          </a>
        </li>
        <li class='nav-item'>
          <a class='nav-link d-flex align-items-center py-2' href='/?new=true'>
            <i class='fa fa-sparkles me-2'></i> New Arrivals
          </a>
        </li>
        <li class='nav-item'>
          <a class='nav-link d-flex align-items-center py-2' href='/accounts/login/'>
            <i class='fa-solid fa-user me-2'></i> Login
          </a>
        </li>
      </ul>
      
      <!-- Desktop Cart and Login -->
      <ul class='navbar-nav d-none d-lg-flex'>
        <li class='nav-item'>
          <a class='nav-link position-relative' href='{% url "cart_view" %}'>
            <i class='fa-solid fa-cart-shopping'></i> 
            <span class='d-none d-xl-inline ms-1'>Cart</span>
            {% if cart_count > 0 %}
            <span class='position-absolute top-0 start-100 translate-middle badge rounded-pill' style='background-color: var(--mint); color: var(--ink);'>
              {{ cart_count }}
              <span class='visually-hidden'>items in cart</span>
            </span>
            {% endif %}
          </a>
        </li>
        <li class='nav-item'>
          <a class='nav-link' href='/accounts/login/'>
            <i class='fa-solid fa-user'></i> 
            <span class='d-none d-xl-inline ms-1'>Login</span>
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>
<!-- Page Header - Visible on all devices -->
<header class='page-hero text-center py-3 py-md-4 bg-white border-bottom'>
  <div class='container'>
    {% block page_header %}{% endblock %}
    <div class='small text-muted mt-2'>{% block breadcrumbs %}{% endblock %}</div>
  </div>
</header>

<!-- Messages -->
{% if messages %}
<div class='container mt-3'>
  {% for message in messages %}
    <div class='alert alert-{{ message.tags }} alert-dismissible fade show'>{{ message }}
      <button type='button' class='btn-close' data-bs-dismiss='alert'></button>
    </div>
  {% endfor %}
</div>
{% endif %}
<main class='container-fluid px-3 px-md-4 py-3 py-md-4'>
  {% block content %}{% endblock %}
</main>
<footer class='footer-gradient text-white pt-5'>
  <div class='container'>
    <div class='row g-4'>
      <div class='col-12 col-sm-6 col-md-3'>
        <h6 class='text-uppercase small'>ShopAway</h6>
        <p class='small text-white-50'>Quality products. Fast delivery. Secure checkout.</p>
      </div>
      <div class='col-12 col-sm-6 col-md-3'>
        <h6 class='text-uppercase small'>Company</h6>
        <ul class='list-unstyled small'>
          <li class='mb-1'><a class='text-white text-decoration-none' href='/about/'>About</a></li>
          <li class='mb-1'><a class='text-white text-decoration-none' href='/contact/'>Contact</a></li>
          <li class='mb-1'><a class='text-white text-decoration-none' href='/blog/'>Blog</a></li>
        </ul>
      </div>
      <div class='col-12 col-sm-6 col-md-3'>
        <h6 class='text-uppercase small'>Help</h6>
        <ul class='list-unstyled small'>
          <li class='mb-1'><a class='text-white text-decoration-none' href='/help/shipping/'>Shipping</a></li>
          <li class='mb-1'><a class='text-white text-decoration-none' href='/help/returns/'>Returns</a></li>
          <li class='mb-1'><a class='text-white text-decoration-none' href='/help/faq/'>FAQ</a></li>
        </ul>
      </div>
      <div class='col-12 col-sm-6 col-md-3'>
        <h6 class='text-uppercase small'>Newsletter</h6>
        <form class='d-flex flex-column flex-sm-row gap-2'>
          <input class='form-control form-control-sm' placeholder='Your email' type='email' aria-label='Email address'>
          <button class='btn btn-sm btn-light' type='submit'>Subscribe</button>
        </form>
      </div>
    </div>
    <div class='small text-white-50 py-3 border-top border-secondary mt-4'>&copy; {{ now|default:2025 }} ShopAway — All rights reserved.</div>
  </div>
</footer>
<!-- Live Chat Widget -->
{% include "chat/chat_button.html" %}
{% include "chat/chat_window.html" %}
<script src="/static/chat/chat.js"></script>
<script src="/static/js/mobile-enhancements.js"></script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // simple intersection observer to reveal sections as they scroll into view
  const observer = new IntersectionObserver(entries => {
    entries.forEach(e => {
      if(e.isIntersecting){ e.target.classList.add('reveal-visible'); }
    })
  }, { threshold: .1 });
  document.querySelectorAll('.reveal').forEach(el => observer.observe(el));
</script>
</body>
</html>